[tox]
envlist = py{27,35,36,37,38}-extra{0,1,2}

[testenv]
changedir = {toxinidir}/ocbpy/tests
commands_pre =
    extra0: echo "Basic installation"
    extra1: mkdir {toxinidir}/pysatData
    extra1: echo "pysat data directory here: " {toxinidir}/pysatData
    extra2: wget https://spdf.sci.gsfc.nasa.gov/pub/software/cdf/dist/cdf37_1/linux/cdf37_1-dist-cdf.tar.gz
    extra2: tar xzf cdf37_1-dist-cdf.tar.gz
    extra2: cd cdf37_1-dist
    extra2: make OS=linux ENV=gnu all
    extra2: make INSTALLDIR={env:HOME} install
    extra2: cd ..
    extra2: git clone https://github.com/lkilcommons/geospacepy-lite.git
    extra2: cd geospacepy-lite
    extra2: python setup.py install
    extra2: cd ..
    extra2: git clone https://github.com/lkilcommons/ssj_auroral_boundary.git
    extra2: cd ssj_auroral_boundary
    extra2: python setup.py install
    extra2: cd ..
    extra2: echo "CDF library is installed here: " {env:CDF_LIB}
    extra2: echo "Finished extra installs for SSJ_Auroral_Boundary"
commands = python -m unittest discover
deps =
    -rrequirements.txt
    extra1: pysat >= 2.0.0
    extra2: scipy
    extra2: matplotlib
    extra2: h5py
    extra2: networkx
    extra2: ephem
    extra2: spacepy
    extra2: colorlog
whitelist_externals = echo
		      gcc
		      gfortran
		      git
		      make
		      tar
		      wget

[testenv:coveralls]
basepython = py37
changedir = {toxinidir}/ocbpy/tests
commands = coverage run -m unittest discover
	   coveralls
deps = #{[testenv:basepython-extra1]}
       {[testenv:basepython-extra2]}
       coverage
       coveralls
passenv = TRAVIS TRAVIS_JOB_ID TRAVIS_BRANCH